{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "testCiCdS3WriteAccess",
      "Effect": "Allow",
      "Action": [
        "s3:AbortMultipartUpload",
        "s3:DeleteBucketPolicy",
        "s3:DeleteBucketWebsite",
        "s3:DeleteObject*",
        "s3:PutObject*",
        "s3:Replicate*",
        "s3:RestoreObject"
      ],
      "Resource": [
        "arn:aws:s3:::$TEST_S3_BUCKET/*",
        "arn:aws:s3:::$TEST_S3_BUCKET_TEST/*",
        "arn:aws:s3:::$TEST_S3_BUCKET_STAGING/*"
      ]
    },
    {
      "Sid": "testCiCdS3ConfigAccess",
      "Effect": "Allow",
      "Action": [
        "s3:PutAccelerateConfiguration",
        "s3:PutBucket*",
        "s3:PutLifecycleConfiguration",
        "s3:PutReplicationConfiguration"
      ],
      "Resource": [
        "arn:aws:s3:::$TEST_S3_BUCKET",
        "arn:aws:s3:::$TEST_S3_BUCKET_TEST",
        "arn:aws:s3:::$TEST_S3_BUCKET_STAGING"
      ]
    },
    {
      "Sid": "testCiCdS3ReadOnlyAccess",
      "Effect": "Allow",
      "Action": [
        "s3:Get*",
        "s3:List*"
      ],
      "Resource": [
        "arn:aws:s3:::$TEST_S3_BUCKET",
        "arn:aws:s3:::$TEST_S3_BUCKET/*",
        "arn:aws:s3:::$TEST_S3_BUCKET_TEST",
        "arn:aws:s3:::$TEST_S3_BUCKET_TEST/*",
        "arn:aws:s3:::$TEST_S3_BUCKET_TEST_FIXTURES",
        "arn:aws:s3:::$TEST_S3_BUCKET_TEST_FIXTURES/*",
        "arn:aws:s3:::$TEST_S3_BUCKET_STAGING",
        "arn:aws:s3:::$TEST_S3_BUCKET_STAGING/*"
      ]
    },
    {
      "Sid": "testCiCdLambdaReadAccess",
      "Action": [
        "lambda:ListFunctions",
        "lambda:ListTags",
        "lambda:TagResource",
        "apigateway:*"
      ],
      "Resource": "*",
      "Effect": "Allow"
    },
    {
      "Sid": "testCiCdIamListRolesAccess",
      "Effect": "Allow",
      "Action": [
        "iam:ListRoles"
      ],
      "Resource": "arn:aws:iam::$account_id:role/"
    },
    {
      "Sid": "testCiCdTestLogging",
      "Effect": "Allow",
      "Action": [
        "logs:*"
      ],
      "Resource": [
        "arn:aws:logs:*:$account_id:log-group:test-*-$TEST_DEPLOYMENT_STAGE*",
        "arn:aws:logs:*:$account_id:log-group:chained-aws-lambda-*",
        "arn:aws:logs:*:$account_id:log-group:test-test-logging*"
      ]
    },
    {
      "Sid": "testCiCdLambdaElasticsearchSNSAdminAccess",
      "Action": [
        "lambda:*",
        "es:*",
        "sns:*"
      ],
      "Resource": [
        "arn:aws:lambda:*:$account_id:function:test-*",
        "arn:aws:lambda:*:$account_id:function:chained-aws-lambda-*",
        "arn:aws:es:*:$account_id:domain/test-index-dev",
        "arn:aws:es:*:$account_id:domain/test-index-dev/*",
        "arn:aws:sns:*:$account_id:test-*",
        "arn:aws:sns:*:$account_id:chained-aws-lambda-*",
        "arn:aws:sns:*:$account_id:domovoi-s3-bucket-events-*"
      ],
      "Effect": "Allow"
    }
  ]
}
